<div>
  <div id="choices"><b style='color:#FF3388;font-weight:bold'>顯示:</b> </div>
  <b class="placeholder-time">時</b>
  <div id="placeholder"></div><!--/div><WHY IE need one more </div> -->
  <b id="day"></b>
</div>

<% content_for :page_spec do %>
  <%= javascript_include_tag "excanvas", "jquery.flot.js", :cache => 'flot' %>
  <script id="source" language="javascript" type="text/javascript">

    $(function () {
        var time = <%= @time %>;
        var sleep_time = <%= @sleep_time %>;
        var target_time = <%= @target_time %>;
        var sleep_target_time = <%= @sleep_target_time %>;

        var time_set = {
          "target": {
              label: "目標時間",
              data: target_time,
              color: 3
            },

          "wake": {
            label: "起床時間",
            data: time,
            color: 1
            },

          "sleep_target": {
            label: "目標睡覺時間",
            data: sleep_target_time,
            color: 0
          },

          "sleep": {
            label: "睡覺時間",
            data: sleep_time,
            color: 2
          }
        };

            var choiceContainer = $("#choices");

                $.each(time_set, function(key, value){
                  choiceContainer.append('<input type="checkbox" name="' + key +
                    '" checked="checked">' + value.label + '</input>');
                });

            choiceContainer.find("input").click(plotAccordingToChoices);

            function plotAccordingToChoices() {
              var data = [];

              choiceContainer.find("input:checked").each(function () {
                var key = $(this).attr("name");
                if (key && time_set[key])
                data.push(time_set[key]);
              });

              if (data.length > 0) {
                $.plot($("#placeholder"), data, {
                    yaxis: { tickSize: 1, min: 0 },
                    xaxis: { tickSize: 1,
                    min: 1,
                    max: 31
                },
                    lines: { show: true },
                    points: { show: true },
                    legend: {
                    show: true,
                    position: "ne",
                    backgroundColor: "#388A3"
                    }
                });
              }
            }

            plotAccordingToChoices();
});
</script>

<% end %>
